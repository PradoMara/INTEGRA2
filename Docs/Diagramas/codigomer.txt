
Table "actividad_usuario" {
  "id" int [pk, not null, increment]
  "usuario_id" int [not null]
  "accion" varchar(50) [default: NULL]
  "detalles" text
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    usuario_id [name: "usuario_id"]
  }
}

Table "calificaciones" {
  "id" int [pk, not null, increment]
  "transaccion_id" int [not null]
  "calificador_id" int [not null]
  "calificado_id" int [not null]
  "puntuacion" decimal(3,2) [default: NULL]
  "comentario" text
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    transaccion_id [name: "transaccion_id"]
    calificador_id [name: "calificador_id"]
    calificado_id [name: "calificado_id"]
  }
}

Table "carrito" {
  "id" int [pk, not null, increment]
  "usuario_id" int [not null]
  "producto_id" int [not null]
  "cantidad" int [not null]

  Indexes {
    usuario_id [name: "usuario_id"]
    producto_id [name: "producto_id"]
  }
}

Table "categorias" {
  "id" int [pk, not null, increment]
  "nombre" varchar(255) [not null]
  "categoria_padre_id" int [default: NULL]

  Indexes {
    categoria_padre_id [name: "categoria_padre_id"]
  }
}

Table "comentarios_publicacion" {
  "id" int [pk, not null, increment]
  "publicacion_id" int [not null]
  "autor_id" int [not null]
  "contenido" text
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    publicacion_id [name: "publicacion_id"]
    autor_id [name: "autor_id"]
  }
}

Table "cuentas" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
  "apellido" varchar(50) [default: NULL]
  "correo" varchar(255) [not null]
  "usuario" varchar(255) [not null]
  "contrasena" varchar(255) [not null]
  "rol_id" int [not null]
  "estado_id" int [not null]
  "fecha_registro" timestamp [default: `CURRENT_TIMESTAMP`]
  "campus" varchar(100) [default: NULL]
  "reputacion" decimal(5,2) [default: '0.00']

  Indexes {
    correo [unique, name: "correo"]
    usuario [unique, name: "usuario"]
    rol_id [name: "rol_id"]
    estado_id [name: "estado_id"]
  }
}

Table "estados_producto" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
}

Table "estados_reporte" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
}

Table "estados_transaccion" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
}

Table "estados_usuario" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
}

Table "foros" {
  "id" int [pk, not null, increment]
  "nombre" varchar(255) [not null]
  "descripcion" text
  "creador_id" int [not null]
  "fecha_creacion" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    creador_id [name: "creador_id"]
  }
}

Table "imagenes_producto" {
  "id" int [pk, not null, increment]
  "producto_id" int [not null]
  "url_imagen" mediumblob

  Indexes {
    producto_id [name: "producto_id"]
  }
}

Table "mensajes" {
  "id" int [pk, not null, increment]
  "remitente_id" int [not null]
  "destinatario_id" int [not null]
  "contenido" text
  "fecha_envio" timestamp [default: `CURRENT_TIMESTAMP`]
  "leido" tinyint(1) [default: '0']

  Indexes {
    remitente_id [name: "remitente_id"]
    destinatario_id [name: "destinatario_id"]
  }
}

Table "metricas_diarias" {
  "id" int [pk, not null, increment]
  "fecha_metricas" date [not null]
  "usuarios_activos" int [default: '0']
  "nuevos_usuarios" int [default: '0']
  "productos_creados" int [default: '0']
  "transacciones_completadas" int [default: '0']
  "mensajes_enviados" int [default: '0']
}

Table "notificaciones" {
  "id" int [pk, not null, increment]
  "usuario_id" int [not null]
  "tipo" varchar(50) [default: NULL]
  "mensaje" text
  "leido" tinyint(1) [default: '0']
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    usuario_id [name: "usuario_id"]
  }
}

Table "productos" {
  "id" int [pk, not null, increment]
  "nombre" varchar(100) [not null]
  "categoria_id" int [default: NULL]
  "vendedor_id" int [not null]
  "precio_anterior" decimal(10,2) [default: NULL]
  "precio_actual" decimal(10,2) [default: NULL]
  "descripcion" text
  "calificacion" decimal(3,2) [default: NULL]
  "cantidad" int [default: NULL]
  "fecha_agregado" timestamp [default: `CURRENT_TIMESTAMP`]
  "estado_id" int [not null]

  Indexes {
    estado_id [name: "estado_id"]
    categoria_id [name: "idx_productos_categoria_id"]
    vendedor_id [name: "idx_productos_vendedor_id"]
  }
}

Table "publicaciones" {
  "id" int [pk, not null, increment]
  "titulo" varchar(255) [default: NULL]
  "cuerpo" text
  "usuario_id" int [not null]
  "estado" varchar(255) [default: NULL]
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    usuario_id [name: "usuario_id"]
  }
}

Table "publicaciones_foro" {
  "id" int [pk, not null, increment]
  "foro_id" int [not null]
  "autor_id" int [not null]
  "titulo" varchar(255) [default: NULL]
  "contenido" text
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    foro_id [name: "foro_id"]
    autor_id [name: "autor_id"]
  }
}

Table "reportes" {
  "id" int [pk, not null, increment]
  "reportante_id" int [not null]
  "usuario_reportado_id" int [default: NULL]
  "producto_id" int [default: NULL]
  "motivo" text
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]
  "estado_id" int [not null]

  Indexes {
    reportante_id [name: "reportante_id"]
    usuario_reportado_id [name: "usuario_reportado_id"]
    producto_id [name: "producto_id"]
    estado_id [name: "estado_id"]
  }
}

Table "resumen_usuario" {
  "usuario_id" int [pk, not null]
  "total_productos" int [default: '0']
  "total_ventas" int [default: '0']
  "total_compras" int [default: '0']
  "promedio_calificacion" decimal(3,2) [default: '0.00']
}

Table "roles" {
  "id" int [pk, not null, increment]
  "nombre" varchar(50) [not null]
}

Table "seguidores" {
  "usuario_sigue_id" int [not null]
  "usuario_seguido_id" int [not null]
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]

  Indexes {
    (usuario_sigue_id, usuario_seguido_id) [pk]
    usuario_seguido_id [name: "usuario_seguido_id"]
  }
}

Table "transacciones" {
  "id" int [pk, not null, increment]
  "producto_id" int [not null]
  "comprador_id" int [not null]
  "vendedor_id" int [not null]
  "fecha" timestamp [default: `CURRENT_TIMESTAMP`]
  "estado_id" int [not null]

  Indexes {
    producto_id [name: "producto_id"]
    comprador_id [name: "comprador_id"]
    vendedor_id [name: "vendedor_id"]
    estado_id [name: "estado_id"]
  }
}

Table "ubicaciones" {
  "id" int [pk, not null, increment]
  "usuario_id" int [not null]
  "nombre_lugar" varchar(255) [default: NULL]
  "descripcion" text

  Indexes {
    usuario_id [name: "usuario_id"]
  }
}

Ref "actividad_usuario_ibfk_1":"cuentas"."id" < "actividad_usuario"."usuario_id" [delete: cascade]

Ref "calificaciones_ibfk_1":"transacciones"."id" < "calificaciones"."transaccion_id" [delete: cascade]

Ref "calificaciones_ibfk_2":"cuentas"."id" < "calificaciones"."calificador_id" [delete: cascade]

Ref "calificaciones_ibfk_3":"cuentas"."id" < "calificaciones"."calificado_id" [delete: cascade]

Ref "carrito_ibfk_1":"cuentas"."id" < "carrito"."usuario_id" [delete: cascade]

Ref "carrito_ibfk_2":"productos"."id" < "carrito"."producto_id" [delete: cascade]

Ref "categorias_ibfk_1":"categorias"."id" < "categorias"."categoria_padre_id" [delete: set null]

Ref "comentarios_publicacion_ibfk_1":"publicaciones_foro"."id" < "comentarios_publicacion"."publicacion_id" [delete: cascade]

Ref "comentarios_publicacion_ibfk_2":"cuentas"."id" < "comentarios_publicacion"."autor_id" [delete: cascade]

Ref "cuentas_ibfk_1":"roles"."id" < "cuentas"."rol_id"

Ref "cuentas_ibfk_2":"estados_usuario"."id" < "cuentas"."estado_id"

Ref "foros_ibfk_1":"cuentas"."id" < "foros"."creador_id" [delete: cascade]

Ref "imagenes_producto_ibfk_1":"productos"."id" < "imagenes_producto"."producto_id" [delete: cascade]

Ref "mensajes_ibfk_1":"cuentas"."id" < "mensajes"."remitente_id" [delete: cascade]

Ref "mensajes_ibfk_2":"cuentas"."id" < "mensajes"."destinatario_id" [delete: cascade]

Ref "notificaciones_ibfk_1":"cuentas"."id" < "notificaciones"."usuario_id" [delete: cascade]

Ref "productos_ibfk_1":"categorias"."id" < "productos"."categoria_id" [delete: set null]

Ref "productos_ibfk_2":"cuentas"."id" < "productos"."vendedor_id" [delete: cascade]

Ref "productos_ibfk_3":"estados_producto"."id" < "productos"."estado_id"

Ref "publicaciones_ibfk_1":"cuentas"."id" < "publicaciones"."usuario_id" [delete: cascade]

Ref "publicaciones_foro_ibfk_1":"foros"."id" < "publicaciones_foro"."foro_id" [delete: cascade]

Ref "publicaciones_foro_ibfk_2":"cuentas"."id" < "publicaciones_foro"."autor_id" [delete: cascade]

Ref "reportes_ibfk_1":"cuentas"."id" < "reportes"."reportante_id" [delete: cascade]

Ref "reportes_ibfk_2":"cuentas"."id" < "reportes"."usuario_reportado_id" [delete: set null]

Ref "reportes_ibfk_3":"productos"."id" < "reportes"."producto_id" [delete: set null]

Ref "reportes_ibfk_4":"estados_reporte"."id" < "reportes"."estado_id"

Ref "resumen_usuario_ibfk_1":"cuentas"."id" < "resumen_usuario"."usuario_id" [delete: cascade]

Ref "seguidores_ibfk_1":"cuentas"."id" < "seguidores"."usuario_sigue_id" [delete: cascade]

Ref "seguidores_ibfk_2":"cuentas"."id" < "seguidores"."usuario_seguido_id" [delete: cascade]

Ref "transacciones_ibfk_1":"productos"."id" < "transacciones"."producto_id" [delete: cascade]

Ref "transacciones_ibfk_2":"cuentas"."id" < "transacciones"."comprador_id" [delete: cascade]

Ref "transacciones_ibfk_3":"cuentas"."id" < "transacciones"."vendedor_id" [delete: cascade]

Ref "transacciones_ibfk_4":"estados_transaccion"."id" < "transacciones"."estado_id"

Ref "ubicaciones_ibfk_1":"cuentas"."id" < "ubicaciones"."usuario_id" [delete: cascade]